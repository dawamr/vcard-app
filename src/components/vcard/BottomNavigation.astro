---
interface Props {
  slug: string;
}

const { slug } = Astro.props;
---

<!-- Bottom Navigation -->
<nav class="fixed bottom-0 left-0 right-0 z-40 border-t border-[color:var(--color-border)]/80 bg-[color:var(--color-bg-card)]/95 backdrop-blur-sm shadow-[0_-6px_24px_rgba(15,23,42,0.12)] dark:bg-[#111827]/95 dark:border-[#1f2937] dark:shadow-none">
  <div class="mx-auto flex max-w-md items-center justify-around py-3">
    <!-- Share Button -->
    <button
      id="share-btn"
      class="flex h-12 w-12 items-center justify-center rounded-full border-2 border-[color:var(--color-border)] bg-white text-[color:var(--color-accent)] dark:bg-transparent dark:border-gray-500 dark:text-[color:var(--color-accent)] hover:border-[color:var(--color-accent-hover)] hover:text-[color:var(--color-accent-hover)] dark:hover:border-[color:var(--color-accent-hover)] dark:hover:text-[color:var(--color-accent-hover)] transition-colors shadow-sm"
      aria-label="Share"
    >
      <svg class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
      </svg>
    </button>

    <!-- QR Code Button (Main) -->
    <button
      id="qr-btn"
      class="flex h-16 w-16 -mt-8 items-center justify-center rounded-full bg-[color:var(--color-accent)] text-black shadow-lg hover:bg-[color:var(--color-accent-hover)] transition-colors"
      aria-label="Show QR Code"
    >
      <svg class="h-8 w-8" fill="currentColor" viewBox="0 0 24 24">
        <path d="M3 3h6v6H3V3zm2 2v2h2V5H5zm8-2h6v6h-6V3zm2 2v2h2V5h-2zM3 13h6v6H3v-6zm2 2v2h2v-2H5zm13-2h1v1h-1v-1zm-3 0h1v1h-1v-1zm-1 1h1v1h-1v-1zm2 0h1v1h-1v-1zm1 1h1v1h-1v-1zm-2 0h1v1h-1v-1zm3 0h1v1h-1v-1zm-1 1h1v1h-1v-1zm1 1h1v1h-1v-1zm0 2h1v1h-1v-1zm-1-1h1v1h-1v-1zm-1 1h1v1h-1v-1zm-1-1h1v1h-1v-1zm-1 1h1v1h-1v-1zm2 0h1v1h-1v-1z"/>
      </svg>
    </button>

    <!-- Save Contact Button -->
    <button
      id="save-btn"
      class="flex h-12 w-12 items-center justify-center rounded-full border-2 border-[color:var(--color-border)] bg-white text-[color:var(--color-accent)] dark:bg-transparent dark:border-gray-500 dark:text-[color:var(--color-accent)] hover:border-[color:var(--color-accent-hover)] hover:text-[color:var(--color-accent-hover)] dark:hover:border-[color:var(--color-accent-hover)] dark:hover:text-[color:var(--color-accent-hover)] transition-colors shadow-sm"
      aria-label="Save Contact"
    >
      <svg class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
      </svg>
    </button>
  </div>
</nav>

<script define:vars={{ slug }}>
  // Share functionality
  document.getElementById('share-btn')?.addEventListener('click', async () => {
    const url = window.location.href;
    if (navigator.share) {
      try {
        await navigator.share({ url, title: 'VCard' });
      } catch (e) {
        // User cancelled
      }
    } else {
      await navigator.clipboard.writeText(url);
      alert('Link copied to clipboard!');
    }
  });

  // QR Modal toggle
  document.getElementById('qr-btn')?.addEventListener('click', () => {
    const modal = document.getElementById('qr-modal');
    const backdrop = document.getElementById('qr-backdrop');
    modal?.classList.toggle('open');
    backdrop?.classList.toggle('open');
  });
</script>
